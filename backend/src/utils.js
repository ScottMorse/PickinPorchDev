function hasPermission(user, permissionsNeeded) {
  if(!user.permissions) return false
  const matchedPermissions = user.permissions.filter(permissionTheyHave =>
    permissionsNeeded.includes(permissionTheyHave)
  );
  if (matchedPermissions.length !== permissionsNeeded.length) {
    return false
  }
  return true
}

exports.emailRegex = new RegExp(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)
exports.nameRegex = new RegExp(/^[\w\d][\w\d\ ]*$/)
exports.passwordRegex = new RegExp(/^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#\$%\^&\*\.])(?=.{8,})/)
exports.badUsernames = ['111111', '123456', '12345678', 'abc123', 'abramov', 'account', 'accounting', 'ad', 'adm', 'admin', 'administrator', 'adver', 'advert', 'advertising', 'afanasev', 'agafonov', 'agata', 'aksenov', 'aleksander', 'aleksandrov', 'alekse', 'alenka', 'alexe', 'alexeev', 'alla', 'anatol', 'andre', 'andreev', 'andrey', 'anna', 'anya', 'ao', 'aozt', 'arhipov', 'art', 'avdeev', 'avto', 'bank', 'baranov', 'Baseball', 'belousov', 'bill', 'billing', 'blinov', 'bobrov', 'bogdanov', 'buh', 'buhg', 'buhgalter', 'buhgalteria', 'business', 'bux', 'catchthismail', 'company', 'contact', 'contactus', 'corp', 'design', 'dir', 'director', 'direktor', 'dragon', 'economist', 'edu', 'email', 'er', 'expert', 'export', 'fabrika', 'fin', 'finance', 'ftp', 'glavbuh', 'glavbux', 'glbuh', 'helloitmenice', 'help', 'holding', 'home', 'hr', 'iamjustsendingthisleter', 'info', 'ingthisleter', 'job', 'john', 'kadry', 'letmein', 'mail', 'manager', 'marketing', 'marketing', 'mike', 'mogggnomgon', 'monkey', 'moscow', 'mysql', 'office', 'ok', 'oracle', 'password', 'personal', 'petgord34truew', 'post', 'postmaster', 'pr', 'qwerty', 'rbury', 'reklama', 'root', 'root', 'sale', 'sales', 'secretar', 'sekretar', 'support', 'test', 'testing', 'thisisjusttestletter', 'trade', 'uploader', 'user', 'webmaster', 'www-data']
exports.badPasswords = ['123456', 'porsche', 'firebird', 'prince', 'rosebud', 'password', 'guitar', 'butter', 'beach', 'jaguar', '12345678', 'chelsea', 'united', 'amateur', 'great', '1234', 'black', 'turtle', '7777777','cool', 'pussy', 'diamond', 'steelers', 'muffin', 'cooper', '12345', 'nascar', 'tiffany', 'redsox', '1313', 'dragon', 'jackson', 'zxcvbn', 'star', 'scorpio', 'qwerty', 'cameron', 'tomcat', 'testing', 'mountain', '696969', '654321', 'golf', 'shannon', 'madison', 'mustang', 'computer', 'bond007', 'murphy', '987654', 'letmein', 'amanda', 'bear', 'frank', 'brazil', 'baseball', 'wizard', 'tiger', 'hannah', 'lauren', 'master', 'xxxxxxxx', 'doctor', 'dave', 'japan', 'michael', 'money', 'gateway', 'eagle1', 'naked', 'football', 'phoenix', 'gators', '11111', 'squirt', 'shadow', 'mickey', 'angel', 'mother', 'stars', 'monkey', 'bailey', 'junior', 'nathan', 'apple', 'abc123', 'knight', 'thx1138', 'raiders', 'alexis', 'pass', 'iceman', 'porno', 'steve', 'aaaa', 'fuckme', 'tigers', 'badboy', 'forever', 'bonnie', '6969', 'purple', 'debbie', 'angela', 'peaches', 'jordan', 'andrea', 'spider', 'viper', 'jasmine', 'harley', 'horny', 'melissa', 'ou812', 'kevin', 'ranger', 'dakota', 'booger', 'jake', 'matt', 'iwantu', 'aaaaaa', '1212', 'lovers', 'qwertyui', 'jennifer', 'player', 'flyers', 'suckit', 'danielle', 'hunter', 'sunshine', 'fish', 'gregory', 'beaver', 'fuck', 'morgan', 'porn', 'buddy', '4321', '2000', 'starwars', 'matrix', 'whatever', '4128', 'test', 'boomer', 'teens', 'young', 'runner', 'batman', 'cowboys', 'scooby', 'nicholas', 'swimming', 'trustno1', 'edward', 'jason', 'lucky', 'dolphin', 'thomas', 'charles', 'walter', 'helpme', 'gordon', 'tigger', 'girls', 'cumshot', 'jackie', 'casper', 'robert', 'booboo', 'boston', 'monica', 'stupid', 'access', 'coffee', 'braves', 'midnight', 'shit', 'love', 'xxxxxx', 'yankee', 'college', 'saturn', 'buster', 'bulldog', 'lover', 'baby', 'gemini', '1234567', 'ncc1701', 'barney', 'cunt', 'apples', 'soccer', 'rabbit', 'victor', 'brian', 'august', 'hockey', 'peanut', 'tucker', 'mark', '3333', 'killer', 'john', 'princess', 'startrek', 'canada', 'george', 'johnny', 'mercedes', 'sierra', 'blazer', 'sexy', 'gandalf', '5150', 'leather', 'cumming', 'andrew', 'spanky', 'doggie', '232323', 'hunting', 'charlie', 'winter', 'zzzzzz', '4444', 'kitty', 'superman', 'brandy', 'gunner', 'beavis', 'rainbow', 'asshole', 'compaq', 'horney', 'bigcock', '112233', 'fuckyou', 'carlos', 'bubba', 'happy', 'arthur', 'dallas', 'tennis', '2112', 'sophie', 'cream', 'jessica', 'james', 'fred', 'ladies', 'calvin', 'panties', 'mike', 'johnson', 'naughty', 'shaved', 'pepper', 'brandon', 'xxxxx', 'giants', 'surfer', '1111', 'fender', 'tits', 'booty', 'samson', 'austin', 'anthony', 'member', 'blonde', 'kelly', 'william', 'blowme', 'boobs', 'fucked', 'paul', 'daniel', 'ferrari', 'donald', 'golden', 'mine', 'golfer', 'cookie', 'bigdaddy', 'king', 'summer', 'chicken', 'bronco', 'fire', 'racing', 'heather', 'maverick', 'penis', 'sandra', '5555', 'hammer', 'chicago', 'voyager', 'pookie', 'eagle', 'yankees', 'joseph', 'rangers', 'packers', 'hentai', 'joshua', 'diablo', 'birdie', 'einstein', 'newyork', 'maggie', 'sexsex', 'trouble', 'dolphins', 'little', 'biteme', 'hardcore', 'white', 'redwings', 'enter', '666666', 'topgun', 'chevy', 'smith', 'ashley', 'willie', 'bigtits', 'winston', 'sticky', 'thunder', 'welcome', 'bitches', 'warrior', 'cocacola', 'cowboy', 'chris', 'green', 'sammy', 'animal', 'silver', 'panther', 'super', 'slut', 'broncos', 'richard', 'yamaha', 'qazwsx', '8675309', 'private', 'fucker', 'justin', 'magic', 'zxcvbnm', 'skippy', 'orange', 'banana', 'lakers', 'nipples', 'marvin', 'merlin', 'driver', 'rachel', 'power', 'blondes', 'michelle', 'marine', 'slayer', 'victoria', 'enjoy', 'corvette', 'angels', 'scott', 'asdfgh', 'girl', 'bigdog', 'fishing', '2222', 'vagina', 'apollo', 'cheese', 'david', 'asdf', 'toyota', 'parker', 'matthew', 'maddog', 'video', 'travis', 'qwert', '121212', 'hooters', 'london', 'hotdog', 'time', 'patrick', 'wilson', '7777', 'paris', 'sydney', 'martin', 'butthead', 'marlboro', 'rock', 'women', 'freedom', 'dennis', 'srinivas', 'xxxx', 'voodoo', 'ginger', 'fucking', 'internet', 'extreme', 'magnum', 'blowjob', 'captain', 'action', 'redskins', 'juice', 'nicole', 'bigdick', 'carter', 'erotic', 'abgrtyu', 'sparky', 'chester', 'jasper', 'dirty', '777777', 'yellow', 'smokey', 'monster', 'ford', 'dreams', 'camaro', 'xavier', 'teresa', 'freddy', 'maxwell', 'secret', 'steven', 'jeremy', 'arsenal', 'music', 'dick', 'viking', '11111111', 'access14','rush2112', 'falcon', 'snoopy', 'bill', 'wolf', 'russia', 'taylor', 'blue', 'crystal', 'nipple', 'scorpion', '111111', 'eagles', 'peter', 'iloveyou', 'rebecca', '131313', 'winner', 'pussies', 'alex', 'tester', '123123', 'samantha', 'cock', 'florida', 'mistress', 'bitch', 'house', 'beer', 'eric', 'phantom', 'hello', 'miller', 'rocket', 'legend', 'billy', 'scooter', 'flower', 'theman', 'movie', '6666', '100', 'please', 'jack', 'oliver', 'success', 'albert']
exports.hasPermission = hasPermission;
